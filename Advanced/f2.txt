important changes in this file.

very important code 
